{"version":3,"file":"DefaultVideoElementResolutionMonitor.js","sourceRoot":"","sources":["../../src/videotile/DefaultVideoElementResolutionMonitor.ts"],"names":[],"mappings":";AAAA,qEAAqE;AACrE,sCAAsC;;AAKtC,MAAqB,oCAAoC;IAKvD;QAJQ,kBAAa,GAAG,IAAI,GAAG,EAAkC,CAAC;QAE1D,YAAO,GAA4B,IAAI,CAAC;QAG9C,IAAI,CAAC,cAAc,GAAG,IAAI,cAAc,CAAC,OAAO,CAAC,EAAE;YACjD,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE;gBAC3B,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC,WAAW,CAAC;gBAC5C,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;aACrC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,eAAe,CAAC,QAAgB,EAAE,SAAiB;QACzD,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,aAAa,EAAE;YACzC,QAAQ,CAAC,6BAA6B,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;SAC7D;IACH,CAAC;IAED,gBAAgB,CAAC,QAAwC;QACvD,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC;IAED,cAAc,CAAC,QAAwC;QACrD,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAED,gBAAgB,CAAC,UAAmC;QAClD,IAAI,IAAI,CAAC,OAAO,KAAK,UAAU,EAAE;YAC/B,OAAO;SACR;QACD,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAC7C;QACD,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC;QAC1B,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAC3C;IACH,CAAC;CACF;AAxCD,uDAwCC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport VideoElementResolutionMonitor, {\n  VideoElementResolutionObserver,\n} from './VideoElementResolutionMonitor';\nexport default class DefaultVideoElementResolutionMonitor implements VideoElementResolutionMonitor {\n  private observerQueue = new Set<VideoElementResolutionObserver>();\n  private resizeObserver: ResizeObserver;\n  private element: HTMLVideoElement | null = null;\n\n  constructor() {\n    this.resizeObserver = new ResizeObserver(entries => {\n      for (const entry of entries) {\n        const { width, height } = entry.contentRect;\n        this.notifyObservers(width, height);\n      }\n    });\n  }\n\n  private notifyObservers(newWidth: number, newHeight: number): void {\n    for (const observer of this.observerQueue) {\n      observer.videoElementResolutionChanged(newWidth, newHeight);\n    }\n  }\n\n  registerObserver(observer: VideoElementResolutionObserver): void {\n    this.observerQueue.add(observer);\n  }\n\n  removeObserver(observer: VideoElementResolutionObserver): void {\n    this.observerQueue.delete(observer);\n  }\n\n  bindVideoElement(newElement: HTMLVideoElement | null): void {\n    if (this.element === newElement) {\n      return;\n    }\n    if (this.element) {\n      this.resizeObserver.unobserve(this.element);\n    }\n    this.element = newElement;\n    if (this.element) {\n      this.resizeObserver.observe(this.element);\n    }\n  }\n}\n"]}