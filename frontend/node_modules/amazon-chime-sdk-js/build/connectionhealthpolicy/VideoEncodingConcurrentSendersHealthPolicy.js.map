{"version":3,"file":"VideoEncodingConcurrentSendersHealthPolicy.js","sourceRoot":"","sources":["../../src/connectionhealthpolicy/VideoEncodingConcurrentSendersHealthPolicy.ts"],"names":[],"mappings":";AAAA,qEAAqE;AACrE,sCAAsC;;;;;AAEtC,8FAAsE;AAItE,wHAAgG;AAEhG,MAAqB,0CACnB,SAAQ,oCAA0B;IAIlC,YAAY,aAAkD,EAAE,IAA0B;QACxF,KAAK,CACH,aAAa,EACb,IAAI,EACJ,iDAAuC,CAAC,4BAA4B,CACrE,CAAC;QACF,IAAI,CAAC,+BAA+B,GAAG,aAAa,CAAC,+BAA+B,CAAC;IACvF,CAAC;IAED,MAAM;QACJ,IAAI,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE;YACnC,iFAAiF;YACjF,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;SAC7B;QACD,IAAI,IAAI,CAAC,WAAW,CAAC,6BAA6B,GAAG,IAAI,CAAC,+BAA+B,EAAE;YACzF,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;SAC7B;QACD,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC;IAC9B,CAAC;CACF;AAxBD,6DAwBC","sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport BaseConnectionHealthPolicy from './BaseConnectionHealthPolicy';\nimport ConnectionHealthData from './ConnectionHealthData';\nimport ConnectionHealthPolicy from './ConnectionHealthPolicy';\nimport ConnectionHealthPolicyConfiguration from './ConnectionHealthPolicyConfiguration';\nimport VideoEncodingConnectionHealthPolicyName from './VideoEncodingConnectionHealthPolicyName';\n\nexport default class VideoEncodingConcurrentSendersHealthPolicy\n  extends BaseConnectionHealthPolicy\n  implements ConnectionHealthPolicy {\n  private readonly concurrentVideoSendersThreshold: number;\n\n  constructor(configuration: ConnectionHealthPolicyConfiguration, data: ConnectionHealthData) {\n    super(\n      configuration,\n      data,\n      VideoEncodingConnectionHealthPolicyName.VideoConcurrentSendersHealth\n    );\n    this.concurrentVideoSendersThreshold = configuration.concurrentVideoSendersThreshold;\n  }\n\n  health(): number {\n    if (this.currentData.isContentShare) {\n      // Do not degrade content share as the number of content share senders is limited\n      return this.maximumHealth();\n    }\n    if (this.currentData.numberOfPublishedVideoSources > this.concurrentVideoSendersThreshold) {\n      return this.minimumHealth();\n    }\n    return this.maximumHealth();\n  }\n}\n"]}